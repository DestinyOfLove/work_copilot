# SCOPSR文章保存器

一个油猴脚本，用于批量保存SCOPSR网站的文章为DOCX格式文档。

## 功能特性

- ✅ 批量保存搜索结果页面的所有文章
- ✅ 保存单篇文章的完整内容  
- ✅ 生成真正的DOCX格式（Office Open XML）
- ✅ 保留文章格式（标题、段落、换行）
- ✅ 支持跨域请求（HTTP/HTTPS混合内容）
- ✅ 显示实时进度和统计信息

## 技术特点

### DOCX格式支持
- 生成Word兼容的HTML格式，保存为.docx扩展名
- 完全兼容Word 2007及以上版本
- 支持WPS、LibreOffice等办公软件
- 文件可直接在Word中打开和编辑

### 格式保留
- 文档标题使用Word原生样式
- 保留原文中的段落和换行
- 中文排版优化（首行缩进、两端对齐）
- 每篇文章自动分页

## 安装使用

### 安装步骤
1. 安装[Tampermonkey](https://www.tampermonkey.net/)浏览器插件
2. 点击Tampermonkey图标，选择"创建新脚本"
3. 将`scopsr-article-saver.user.js`的内容复制粘贴进去
4. 保存脚本（Ctrl+S）

### 使用方法

#### 批量保存
1. 访问SCOPSR搜索结果页面
2. 页面右侧出现绿色"保存为DOCX文档"按钮
3. 点击按钮开始收集文章
4. 显示进度：`正在处理 X/Y (成功:A 失败:B)`
5. 自动下载生成的DOCX文件

#### 单篇保存
1. 访问文章详情页面
2. 页面右侧出现"保存为DOCX文档"按钮
3. 点击保存当前文章

## 生成的文档

### 文档结构
```
封面
├── 标题：SCOPSR文章集
├── 生成日期
└── 文章数量统计

正文（每篇文章）
├── 文章标题（Heading 1）
├── 发布时间（灰色小字）
├── 来源链接（灰色小字）
└── 文章内容（格式化段落）
```

### 文件命名
- 批量保存：`SCOPSR文章集_YYYY-MM-DD.docx`
- 单篇保存：`文章标题_YYYY-MM-DD.docx`

## 更新历史

### v3.1 (2024-08)
- 优化DOCX生成方式，提高稳定性
- 使用HTML兼容格式，确保更好的兼容性
- 保留每行换行，每行作为独立段落
- 移除外部库依赖，提高加载速度

### v1.1 (2024-08)
- 修复跨域请求问题
- 使用GM_xmlhttpRequest处理HTTP/HTTPS混合内容

### v1.0 (2024-08)
- 初始版本
- 支持JSON格式输出

## 技术实现

- **HTML兼容格式** - 生成Word兼容的HTML结构
- **MSO标签** - 使用Microsoft Office专用XML标签
- **GM_xmlhttpRequest** - 跨域请求处理
- **GM_download** - 文件下载管理

## 注意事项

1. 批量保存时会逐个获取文章内容，请耐心等待
2. 建议一次不要保存太多文章（建议少于50篇）
3. 生成的文件扩展名为`.docx`，可在Word中直接打开
4. 文档使用HTML兼容格式，确保最大兼容性
5. 每个换行都会保留为独立段落
6. 如果文章获取失败，会在文档中标记为红色提示

## 问题反馈

如遇到问题，请查看浏览器控制台（F12）的错误信息。

## 许可证

MIT License